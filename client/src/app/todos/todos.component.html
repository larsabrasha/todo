<div class="pt-3 list-group mx-auto" style="max-width: 500px">
  <div
    *ngIf="(todos$ | async) as todos"
    cdkDropList
    (cdkDropListDropped)="drop($event)"
  >
    <ng-container *ngFor="let todoId of (todoIds$ | async)">
      <div
        *ngIf="todos[todoId] as todo"
        class="list-group-item list-group-item-action"
        [class.bg-checked]="todo.checked"
        [class.bg-unchecked]="todo.checked == false"
        [ngStyle]="{
          'text-decoration': todo.checked ? 'line-through' : 'none',
          opacity: todo.checked ? 0.25 : 1
        }"
        style="user-select: none; cursor: pointer;"
        (click)="toggle(todo)"
        cdkDrag
        [cdkDragData]="todo"
      >
      <div class="float-right ml-1" cdkDragHandle style="cursor: move; opacity: 0.1"><i class="fa fa-arrows-alt"></i></div>
        {{ todo.title }}
      </div>
    </ng-container>
  </div>

  <div class="mt-3">
    <form [formGroup]="form" (ngSubmit)="onSubmit()">
      <input
        type="text"
        class="form-control gentle"
        [placeholder]="placeholder"
        formControlName="title"
        style="opacity: 0.5"
        (focus)="onFocus()"
        (blur)="onBlur()"
      />
    </form>
  </div>

  <div class="dropdown ml-auto mt-3 ">
    <button
      class="btn btn-sm btn-light gentle"
      type="button"
      id="dropdownMenu"
      data-toggle="dropdown"
      aria-haspopup="true"
      aria-expanded="false"
      style="opacity: 0.25"
    >
      <i class="fas fa-ellipsis-h"></i>
    </button>
    <div
      class="dropdown-menu dropdown-menu-right"
      aria-labelledby="dropdownMenu"
    >
      <a
        href=""
        class="dropdown-item"
        (click)="deleteCompletedTodos(); $event.preventDefault()"
        ><i class="fas fa-trash fa-fw"></i> Delete completed</a
      >
      <div class="dropdown-divider"></div>
      <a [routerLink]="['/todos/source-editor']" class="dropdown-item"
        ><i class="fas fa-edit fa-fw"></i> Edit source</a
      >
    </div>
  </div>
</div>
